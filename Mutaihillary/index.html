<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web3Forms</title>
</head>

<body>
    <form method="POST" name="submit-to-google-sheet" id="form">

        <input type="hidden" name="access_key" value="83603386-2ea0-4666-9470-8fc26f28aa5b">
        <label for="name">Name:
            <input type="text" name="Name" required>
        </label>
        <label for="name">Email:
            <input type="email" name="Email" required>
        </label>
        <label for="name">Message:
            <textarea name="Message" required></textarea>
        </label>
        <!-- <div class="h-captcha" data-captcha="true"></div> -->

        <button type="submit">Submit Form</button>

        <div id="result"></div>

    </form>

    <script src="https://web3forms.com/client/script.js" async defer></script>
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbynMgpS1jbTNHH-qJrHGAM-ZB2kyNFGJy3YiqES1qgXfEi-__tiooyFerT8vPsOExYa/exec'
        const form = document.forms['submit-to-google-sheet']

        form.addEventListener('submit', e => {
            e.preventDefault()
            fetch(scriptURL, {
                method: 'POST', body: new FormData(form)
            })
            console.log(body)
                .then(response => console.log('Success!', response))
                .catch(error => console.error('Error!', error.message))
        })
    </script>

    //
    <script>
        //       const form = document.getElementById('form');
        //       const result = document.getElementById('result');
        //
        //       form.addEventListener('submit', function (e) {
        //           e.preventDefault();
        //           const formData = new FormData(form);
        //           const object = Object.fromEntries(formData);
        //           const json = JSON.stringify(object);
        //           result.innerHTML = "Please wait..."
        //
        //           fetch('https://api.web3forms.com/submit', {
        //               method: 'POST',
        //               headers: {
        //                   'Content-Type': 'application/json',
        //                   'Accept': 'application/json'
        //               },
        //               body: json
        //           })
        //               .then(async (response) => {
        //                   let json = await response.json();
        //                   if (response.status == 200) {
        //                       result.innerHTML = "Form submitted successfully";
        //                   } else {
        //                       console.log(response);
        //                       result.innerHTML = json.message;
        //                   }
        //               })
        //               .catch(error => {
        //                   console.log(error);
        //                   result.innerHTML = "Something went wrong!";
        //               })
        //               .then(function () {
        //                   form.reset();
        //                   setTimeout(() => {
        //                       result.style.display = "none";
        //                   }, 3000);
        //               });
        //       });

    </script>
</body>

</html>
